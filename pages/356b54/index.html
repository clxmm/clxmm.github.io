<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>01redis | clxmm</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/icon.jpeg">
    <meta name="description" content="111">
    <meta name="keywords" content="clxmm">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.91c54501.css" as="style"><link rel="preload" href="/assets/js/app.5310cdc4.js" as="script"><link rel="preload" href="/assets/js/2.c9184447.js" as="script"><link rel="preload" href="/assets/js/3.b86c239d.js" as="script"><link rel="preload" href="/assets/js/11.f29116e0.js" as="script"><link rel="prefetch" href="/assets/js/10.3bb44866.js"><link rel="prefetch" href="/assets/js/12.eaa80fe1.js"><link rel="prefetch" href="/assets/js/13.607f8a97.js"><link rel="prefetch" href="/assets/js/14.715b1c48.js"><link rel="prefetch" href="/assets/js/15.71d2dbc1.js"><link rel="prefetch" href="/assets/js/16.b263764f.js"><link rel="prefetch" href="/assets/js/17.7201f4e6.js"><link rel="prefetch" href="/assets/js/18.94bf12e5.js"><link rel="prefetch" href="/assets/js/19.416a156a.js"><link rel="prefetch" href="/assets/js/20.33931d01.js"><link rel="prefetch" href="/assets/js/21.8e58e1f5.js"><link rel="prefetch" href="/assets/js/22.e5a8bb91.js"><link rel="prefetch" href="/assets/js/23.b24b112f.js"><link rel="prefetch" href="/assets/js/24.98b533de.js"><link rel="prefetch" href="/assets/js/25.0bc0ae20.js"><link rel="prefetch" href="/assets/js/26.2c564d65.js"><link rel="prefetch" href="/assets/js/27.b1757049.js"><link rel="prefetch" href="/assets/js/28.1cc196ce.js"><link rel="prefetch" href="/assets/js/29.86f67f48.js"><link rel="prefetch" href="/assets/js/30.c88df1af.js"><link rel="prefetch" href="/assets/js/31.0374d8b8.js"><link rel="prefetch" href="/assets/js/32.caf9bf23.js"><link rel="prefetch" href="/assets/js/33.c1da0085.js"><link rel="prefetch" href="/assets/js/34.1f76479f.js"><link rel="prefetch" href="/assets/js/35.32aa3010.js"><link rel="prefetch" href="/assets/js/36.3dbaf336.js"><link rel="prefetch" href="/assets/js/37.232d9208.js"><link rel="prefetch" href="/assets/js/38.29f11a39.js"><link rel="prefetch" href="/assets/js/39.c83c649b.js"><link rel="prefetch" href="/assets/js/4.f96b24c5.js"><link rel="prefetch" href="/assets/js/40.713de3d2.js"><link rel="prefetch" href="/assets/js/41.4638cde0.js"><link rel="prefetch" href="/assets/js/5.2e4cbb9e.js"><link rel="prefetch" href="/assets/js/6.7b582dbb.js"><link rel="prefetch" href="/assets/js/7.ac6d362f.js"><link rel="prefetch" href="/assets/js/8.e1180ebd.js"><link rel="prefetch" href="/assets/js/9.058f530e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.91c54501.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">clxmm</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端学习" class="dropdown-title"><a href="/java/" class="link-title">后端学习</a> <span class="title" style="display:none;">后端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>01redis学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/356b54/" aria-current="page" class="nav-link router-link-exact-active router-link-active">01redis开始</a></li></ul></li><li class="dropdown-item"><h4>02redis学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/356b51/" class="nav-link">01redis开始</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习" class="dropdown-title"><a href="/web/" class="link-title">前端学习</a> <span class="title" style="display:none;">前端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>vue2学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/7f2831/" class="nav-link">01vue学习</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><a href="/other/" class="link-title">其他</a> <span class="title" style="display:none;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>centos安装zsh</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/435ca7/" class="nav-link">centos安装zsh</a></li></ul></li></ul></div></div> <a href="https://github.com/clxmm/clxmm" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端学习" class="dropdown-title"><a href="/java/" class="link-title">后端学习</a> <span class="title" style="display:none;">后端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>01redis学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/356b54/" aria-current="page" class="nav-link router-link-exact-active router-link-active">01redis开始</a></li></ul></li><li class="dropdown-item"><h4>02redis学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/356b51/" class="nav-link">01redis开始</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习" class="dropdown-title"><a href="/web/" class="link-title">前端学习</a> <span class="title" style="display:none;">前端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>vue2学习</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/7f2831/" class="nav-link">01vue学习</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><a href="/other/" class="link-title">其他</a> <span class="title" style="display:none;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>centos安装zsh</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/435ca7/" class="nav-link">centos安装zsh</a></li></ul></li></ul></div></div> <a href="https://github.com/clxmm/clxmm" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>redis</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/356b54/" aria-current="page" class="active sidebar-link">01redis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_1-redis的优势-能干什么" class="sidebar-link">1.Redis的优势-能干什么</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_2-redis的安装" class="sidebar-link">2.Redis的安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_2-1-官网地址" class="sidebar-link">2.1 官网地址</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_2-2-下载安装" class="sidebar-link">2.2 下载安装</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_3-文档资料" class="sidebar-link">3.文档资料</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_4-redis的10大数据类型" class="sidebar-link">4.Redis的10大数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-1-redis字符串-string" class="sidebar-link">4.1 redis字符串（String）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-2-redis列表-list" class="sidebar-link">4.2 redis列表（List）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-3-redis哈希表-hash" class="sidebar-link">4.3 redis哈希表（Hash）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-4-redis集合-set" class="sidebar-link">4.4 redis集合（Set）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-5-redis有序集合-zset" class="sidebar-link">4.5 redis有序集合（ZSet）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-6redis地理空间-geo" class="sidebar-link">4.6redis地理空间（GEO）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-7redis基数统计-hyperloglog" class="sidebar-link">4.7redis基数统计（HyperLogLog）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-8-redis位图-bitmap" class="sidebar-link">4.8 redis位图（bitmap）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-9-redis位域-bitfield" class="sidebar-link">4.9 redis位域（bitfield）</a></li><li class="sidebar-sub-header level3"><a href="/pages/356b54/#_4-10-redis流-stream" class="sidebar-link">4.10 redis流（Stream）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_5-文档" class="sidebar-link">5. 文档</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_6-redis-key" class="sidebar-link">6.Redis key</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_7-string-类型" class="sidebar-link">7.String 类型</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_8-列表list" class="sidebar-link">8.列表List</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_9-hash哈希" class="sidebar-link">9.hash哈希</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_10-set集合" class="sidebar-link">10.set集合</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_11-zset有序集合" class="sidebar-link">11.zset有序集合</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_12-位图bitmaps" class="sidebar-link">12.位图Bitmaps</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_13-基数统计hyperloglog" class="sidebar-link">13.基数统计HyperLogLog</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_14-redis地理空间-geo" class="sidebar-link">14.Redis地理空间(GEO)</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_15-redis-stream" class="sidebar-link">15.Redis Stream</a></li><li class="sidebar-sub-header level2"><a href="/pages/356b54/#_15-redis的stream流" class="sidebar-link">15.Redis的Stream流</a></li></ul></li><li><a href="/pages/2a37ab/" class="sidebar-link">02redis持久化</a></li><li><a href="/pages/f01e54/" class="sidebar-link">03redis事务和管道</a></li><li><a href="/pages/75cece/" class="sidebar-link">04redis发布与订阅</a></li><li><a href="/pages/4a54cc/" class="sidebar-link">05Redis复制(replica)</a></li><li><a href="/pages/9788da/" class="sidebar-link">06Redis哨兵(sentinel)</a></li><li><a href="/pages/551b67/" class="sidebar-link">07Redis集群(cluster)</a></li><li><a href="/pages/ebe3c7/" class="sidebar-link">08redis与SpringBoot集成</a></li><li><a href="/pages/fa5943/" class="sidebar-link">redis单线程与多线程</a></li><li><a href="/pages/ec796f/" class="sidebar-link">redis的BigKey</a></li><li><a href="/pages/e53d85/" class="sidebar-link">redis缓存双写一致性</a></li><li><a href="/pages/a32a66/" class="sidebar-link">12redis与mysql双写一致性</a></li><li><a href="/pages/8249db/" class="sidebar-link">13案列bitmap-hyperlog-geo</a></li><li><a href="/pages/d7b34c/" class="sidebar-link">14布隆过滤器BloomFilter</a></li><li><a href="/pages/cdc2c8/" class="sidebar-link">缓存预热、雪崩、击穿、穿透</a></li><li><a href="/pages/6b15da/" class="sidebar-link">redis的分布式锁</a></li><li><a href="/pages/6be928/" class="sidebar-link">17Redlock算法和缓存淘汰</a></li><li><a href="/pages/086c39/" class="sidebar-link">18Redis源码</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>redis02</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/java/#后端学习" data-v-06970110>后端学习</a></li><li data-v-06970110><a href="/java/#redis" data-v-06970110>redis</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/clxmm" target="_blank" title="作者" class="beLink" data-v-06970110>clxmm</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2024-06-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><!---->01redis<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="_1-redis的优势-能干什么"><a href="#_1-redis的优势-能干什么" class="header-anchor">#</a> 1.Redis的优势-能干什么</h2> <ul><li>1.性能极高 – Redis能读的速度是110000次/秒,写的速度是81000次/秒</li> <li>2.数据类型丰富，不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构</li> <li>3.Redis支持数据的持久化，可以将内存中的数据保持在磁盘中，重启的时候可以再次加载进行使用</li> <li>4.Redis支持数据的备份，即master-slave模式的数据备份</li></ul> <h2 id="_2-redis的安装"><a href="#_2-redis的安装" class="header-anchor">#</a> 2.Redis的安装</h2> <h3 id="_2-1-官网地址"><a href="#_2-1-官网地址" class="header-anchor">#</a> 2.1 官网地址</h3> <p><a href="https://redis.io/" target="_blank" rel="noopener noreferrer">https://redis.io/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>中文：</p> <ul><li><a href="http://www.redis.cn/" target="_blank" rel="noopener noreferrer">http://www.redis.cn/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.redis.com.cn/documentation.html" target="_blank" rel="noopener noreferrer">https://www.redis.com.cn/documentation.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="_2-2-下载安装"><a href="#_2-2-下载安装" class="header-anchor">#</a> 2.2 下载安装</h3> <ul><li><p>安装包： <a href="https://redis.io/download/" target="_blank" rel="noopener noreferrer">https://redis.io/download/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Linux安装，以centos为例</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> <span class="token function">wget</span>

<span class="token builtin class-name">pwd</span>
/home/app/redis

<span class="token function">wget</span> https://download.redis.io/releases/redis-7.0.0.tar.gz

<span class="token comment">## 解压</span>
 <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> redis-7.0.0.tar.gz
 
 <span class="token comment">## 错误</span>
 MAKE hiredis
<span class="token builtin class-name">cd</span> hiredis <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> static
make<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: 进入目录“/home/app/redis/redis-7.0.0/deps/hiredis”
cc <span class="token parameter variable">-std</span><span class="token operator">=</span>c99 <span class="token parameter variable">-c</span> <span class="token parameter variable">-O3</span> <span class="token parameter variable">-fPIC</span>   <span class="token parameter variable">-Wall</span> <span class="token parameter variable">-W</span> -Wstrict-prototypes -Wwrite-strings -Wno-missing-field-initializers <span class="token parameter variable">-g</span> <span class="token parameter variable">-ggdb</span> <span class="token parameter variable">-pedantic</span> alloc.c
make<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: cc：命令未找到
make<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: *** <span class="token punctuation">[</span>alloc.o<span class="token punctuation">]</span> 错误 <span class="token number">127</span>
make<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: 离开目录“/home/app/redis/redis-7.0.0/deps/hiredis”
make<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: *** <span class="token punctuation">[</span>hiredis<span class="token punctuation">]</span> 错误 <span class="token number">2</span>
make<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: 离开目录“/home/app/redis/redis-7.0.0/deps”
make<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token punctuation">[</span>persist-settings<span class="token punctuation">]</span> 错误 <span class="token number">2</span> <span class="token punctuation">(</span>忽略<span class="token punctuation">)</span>
    CC adlist.o
/bin/sh: cc: 未找到命令
make<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: *** <span class="token punctuation">[</span>adlist.o<span class="token punctuation">]</span> 错误 <span class="token number">127</span>
make<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: 离开目录“/home/app/redis/redis-7.0.0/src”
make: *** <span class="token punctuation">[</span>all<span class="token punctuation">]</span> 错误 <span class="token number">2</span>


<span class="token comment">## 安装gcc</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> gcc

<span class="token comment">## 缺少python3</span>

which: no python3 <span class="token keyword">in</span> <span class="token punctuation">(</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/home/app/jdk1.8.0_401/bin:/home/app/apache-maven-3.8.1/bin:/root/bin<span class="token punctuation">)</span>

<span class="token comment">## 安装python3</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> python3


<span class="token comment">## 执行make 编译</span>
<span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>
<span class="token comment"># cd src</span>
<span class="token comment"># ./redis-server</span>

修改配置
<span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0
protected-mode no
requirepass <span class="token number">123456</span>

<span class="token comment"># cd src</span>

redis-server /home/app/redis/redis-7.0.0/redis.conf
/usr/local/bin/redis-server /home/app/redis/redis-7.0.0/redis.conf

<span class="token comment"># cd src</span>
<span class="token comment"># ./redis-cli</span>
redis<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> foo bar
OK
redis<span class="token operator">&gt;</span> get foo
<span class="token string">&quot;bar&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div></li> <li><p>docker 安装</p></li></ul> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code>  version: '3'
  services:
    redis:
      image: registry.cn-hangzhou.aliyuncs.com/zhengqing/redis:7.0.5                    # 镜像'redis:7.0.5'
      container_name: redis                                                             # 容器名为'redis'
  <span class="token comment">#    restart: unless-stopped                                                                   # 指定容器退出后的重启策略为始终重启，但是不考虑在Docker守护进程启动时就已经停止了的容器</span>
      command: redis-server --requirepass 123456 --appendonly yes # 启动redis服务并添加密码为：123456,并开启redis持久化配置
      environment:                        # 设置环境变量,相当于docker run命令中的-e
        TZ: Asia/Shanghai
        LANG: en_US.UTF-8
      volumes:                            # 数据卷挂载路径设置,将本机目录映射到容器目录
        - &quot;./redis/data:/data&quot;
        - &quot;./redis/config/redis.conf:/etc/redis/redis.conf&quot;  # `redis.conf`文件内容`http://download.redis.io/redis-stable/redis.conf`
      ports:                              # 映射端口
        - &quot;6379:6379&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>进入redis命令行</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>  <span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">777</span> ./redis
  <span class="token comment"># 运行 -- 单机模式</span>
  <span class="token function">docker-compose</span> <span class="token parameter variable">-f</span> docker-compose-redis.yml <span class="token parameter variable">-p</span> redis up <span class="token parameter variable">-d</span>
  
  <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> redis redis-cli <span class="token parameter variable">-a</span> <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_3-文档资料"><a href="#_3-文档资料" class="header-anchor">#</a> 3.文档资料</h2> <p><strong>源码地址</strong> <a href="https://github.com/redis/redis" target="_blank" rel="noopener noreferrer">https://github.com/redis/redis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>在线测试：</strong> <a href="https://try.redis.io/" target="_blank" rel="noopener noreferrer">https://try.redis.io/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>参考命令：</strong> <a href="http://doc.redisfans.com/" target="_blank" rel="noopener noreferrer">http://doc.redisfans.com/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_4-redis的10大数据类型"><a href="#_4-redis的10大数据类型" class="header-anchor">#</a> 4.Redis的10大数据类型</h2> <p><strong>这里说的数据类型是value的数据类型，key的类型都是字符串</strong></p> <h3 id="_4-1-redis字符串-string"><a href="#_4-1-redis字符串-string" class="header-anchor">#</a> 4.1 redis字符串（String）</h3> <p>String（字符串）,string是redis最基本的类型，一个key对应一个value，string类型是二进制安全的，意思是redis的string可以包含任何数据，比如jpg图片或者序列化的对象 。</p> <p>string类型是Redis最基本的数据类型，一个redis中字符串value最多可以是512M</p> <h3 id="_4-2-redis列表-list"><a href="#_4-2-redis列表-list" class="header-anchor">#</a> 4.2 redis列表（List）</h3> <p>List（列表），Redis列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）</p> <p>它的底层实际是个双端链表，最多可以包含 2^32 - 1 个元素 (4294967295, 每个列表超过40亿个元素)</p> <h3 id="_4-3-redis哈希表-hash"><a href="#_4-3-redis哈希表-hash" class="header-anchor">#</a> 4.3 redis哈希表（Hash）</h3> <p>Redis hash 是一个 string 类型的 field（字段） 和 value（值） 的映射表，hash 特别适合用于存储对象。</p> <p>Redis 中每个 hash 可以存储 2^32 - 1 键值对（40多亿）</p> <h3 id="_4-4-redis集合-set"><a href="#_4-4-redis集合-set" class="header-anchor">#</a> 4.4 redis集合（Set）</h3> <p>Set（集合）</p> <p>Redis 的 Set 是 String 类型的无序集合。集合成员是唯一的，这就意味着集合中不能出现重复的数据，集合对象的编码可以是 intset 或者 hashtable。</p> <p>Redis 中Set集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。</p> <p>集合中最大的成员数为 2^32 - 1 (4294967295, 每个集合可存储40多亿个成员)</p> <h3 id="_4-5-redis有序集合-zset"><a href="#_4-5-redis有序集合-zset" class="header-anchor">#</a> 4.5 redis有序集合（ZSet）</h3> <p>zset(sorted set：有序集合)</p> <p>Redis zset 和 set 一样也是string类型元素的集合,且不允许重复的成员。</p> <p>不同的是每个元素都会关联一个double类型的分数，redis正是通过分数来为集合中的成员进行从小到大的排序。</p> <p>zset的成员是唯一的,但分数(score)却可以重复。</p> <p>zset集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。 集合中最大的成员数为 2^32 - 1</p> <h3 id="_4-6redis地理空间-geo"><a href="#_4-6redis地理空间-geo" class="header-anchor">#</a> 4.6redis地理空间（GEO）</h3> <p>Redis GEO 主要用于存储地理位置信息，并对存储的信息进行操作，包括</p> <p>添加地理位置的坐标。</p> <p>获取地理位置的坐标。</p> <p>计算两个位置之间的距离。</p> <p>根据用户给定的经纬度坐标来获取指定范围内的地理位置集合</p> <h3 id="_4-7redis基数统计-hyperloglog"><a href="#_4-7redis基数统计-hyperloglog" class="header-anchor">#</a> 4.7redis基数统计（HyperLogLog）</h3> <p>HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定且是很小的。</p> <p>在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。</p> <p>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</p> <h3 id="_4-8-redis位图-bitmap"><a href="#_4-8-redis位图-bitmap" class="header-anchor">#</a> 4.8 redis位图（bitmap）</h3> <p>由0和1状态表现的二进制位的bit数组</p> <h3 id="_4-9-redis位域-bitfield"><a href="#_4-9-redis位域-bitfield" class="header-anchor">#</a> 4.9 redis位域（bitfield）</h3> <p>通过bitfield命令可以一次性操作多个比特位域(指的是连续的多个比特位)，它会执行一系列操作并返回一个响应数组，这个数组中的元素对应参数列表中的相应操作的执行结果。</p> <p>说白了就是通过bitfield命令我们可以一次性对多个比特位域进行操作。</p> <h3 id="_4-10-redis流-stream"><a href="#_4-10-redis流-stream" class="header-anchor">#</a> 4.10 redis流（Stream）</h3> <p>Redis Stream 是 Redis 5.0 版本新增加的数据结构。</p> <p>Redis Stream 主要用于消息队列（MQ，Message Queue），Redis 本身是有一个 Redis 发布订阅 (pub/sub) 来实现消息队列的功能，但它有个缺点就是消息无法持久化，如果出现网络断开、Redis 宕机等，消息就会被丢弃。</p> <p>简单来说发布订阅 (pub/sub) 可以分发消息，但无法记录历史消息。</p> <p>而 Redis Stream 提供了消息的持久化和主备复制功能，可以让任何客户端访问任何时刻的数据，并且能记住每一个客户端的访问位置，还能保证消息不丢失</p> <h2 id="_5-文档"><a href="#_5-文档" class="header-anchor">#</a> 5. 文档</h2> <p>官网：<a href="https://redis.io/commands/" target="_blank" rel="noopener noreferrer">https://redis.io/commands/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>中文：<a href="http://www.redis.cn/commands.html" target="_blank" rel="noopener noreferrer">http://www.redis.cn/commands.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_6-redis-key"><a href="#_6-redis-key" class="header-anchor">#</a> 6.Redis key</h2> <p>key的操作：<a href="https://www.runoob.com/redis/redis-keys.html" target="_blank" rel="noopener noreferrer">Redis Key<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>常用操作</p> <ul><li><code>keys *</code> 获取所有的key</li> <li><code>exists key</code>判断某一个key。是否存在</li> <li><code>type key</code> 查看key的数据类型</li> <li><code>del key</code> 删除key</li> <li><code>unlink key</code> 非阻塞删除，仅仅将keys从keyspace元数据中删除，真正的删除会在后续异步中操作。</li> <li><code>ttl key</code> 查看还有多少秒过期，-1表示永不过期，-2表示已过期</li> <li><code>expire key</code> 为给定的key设置过期时间</li> <li><code>move key db</code> 将当前数据库的 key移动到给定的数据库 db 当中</li> <li><code>select dbindex</code> 切换数据库【0-15】，默认为0</li> <li><code>dbsize</code> 查看当前数据库key的数量</li> <li><code>flushdb</code> 清空当前库</li> <li><code>flushall</code> 清空所有数据库</li></ul> <h2 id="_7-string-类型"><a href="#_7-string-类型" class="header-anchor">#</a> 7.String 类型</h2> <ol><li><p>最常用的类型，<a href="https://www.runoob.com/redis/redis-strings.html" target="_blank" rel="noopener noreferrer">Redis 字符串(String) | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>单值单value</p></li> <li><p>最常用的： <code>set key value</code> ,<code>get key</code></p></li> <li><p>set命令详情： <a href="https://redis.com.cn/commands/set.html" target="_blank" rel="noopener noreferrer">Redis SET 命令 设置键的字符串值<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><code>EX</code> <em>seconds</em> – 设置键key的过期时间，单位时秒</li> <li><code>PX</code> <em>milliseconds</em> – 设置键key的过期时间，单位时毫秒</li> <li><code>NX</code> – 只有键key不存在的时候才会设置key的值</li> <li><code>XX</code> – 只有键key存在的时候才会设置key的值</li> <li><code>KEEPTTL</code> -- 获取 key 的过期时间</li> <li><a href="https://redis.com.cn/commands/get.html" target="_blank" rel="noopener noreferrer">GET<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> -- 返回 key 存储的值，如果 key 不存在返回空</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">## nx key不存在，设置</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token builtin class-name">set</span> k1 v1 nx
OK
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token builtin class-name">set</span> k1 v2 nx

nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> get k1
v1
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> 

<span class="token comment">## 设置过期时间</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token builtin class-name">set</span> k2 ve ex <span class="token number">100</span>
OK
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ttl k2
<span class="token number">94</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>get常用操作：<a href="https://redis.com.cn/commands/get.html" target="_blank" rel="noopener noreferrer">Redis GET 命令 获取key的值<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>同时设置、获取多个值，<strong>mset、mget</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> mset k1 v2 k2 v2 k3 v3
OK
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> mget k1 k2 k3
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>数值的增减，<code>incr key</code> ,  <code>decr key</code></p></li> <li><p>获取字符串长度和内容追加。<code>strlen key</code> <code>append key value</code></p></li> <li><p>分布式锁；setnx key value 、setex</p></li></ol> <h2 id="_8-列表list"><a href="#_8-列表list" class="header-anchor">#</a> 8.列表List</h2> <ol><li><p>常用命令：<a href="https://www.runoob.com/redis/redis-lists.html" target="_blank" rel="noopener noreferrer">Redis 列表(List) | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>类型：单key多个value</p></li> <li><p>一个双端链表的结构，容量是2的32次方减1个元素，大概40多亿，主要功能有push/pop等，一般用在栈、队列、消息队列等场景。</p> <ol><li>left、right都可以插入添加；</li> <li>如果键不存在，创建新的链表；</li> <li>如果键已存在，新增内容；</li> <li>如果值全移除，对应的键也就消失了。</li> <li>它的底层实际是个<strong>双向链表，对两端的操作性能很高，通过索引下标的操作中间的节点性能会较差。</strong></li></ol></li> <li><p>LPUSH 、RPUSH、LRANGE</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> lpush list1 <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span>
<span class="token number">6</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> lrange list1 <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;6&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;5&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;4&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;3&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;2&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;1&quot;</span>

nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> rpush list2 <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span> <span class="token number">66</span>
<span class="token number">6</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> lrange list2 <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;11&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;22&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;33&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;44&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;55&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;66&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li> <li><p>lopo、rpop,弹出元素</p></li> <li><p>lindex 按照索引下标获得元素（从上到下）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> lrange list1 <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;6&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;5&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;4&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;3&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;2&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;1&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> lindex list1 <span class="token number">0</span>
<span class="token number">6</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> lindex list1 <span class="token number">5</span>
<span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>llen 列表中的元素个数</p></li> <li><p>lrem key 数字n 给定值v。删除n个等于v的元素</p></li> <li><p>ltrim key 开始index 结束index，截取指定范围后，再赋值给key</p></li> <li><p>RPOPLPUSH SOURCE_KEY_NAME DESTINATION_KEY_NAME, 移除列表的最后一个元素,并将该元素添加到另一个列表并返回</p></li> <li><p>LSET KEY_NAME INDEX VALUE,Redis Lset 通过索引来设置元素的值。</p></li> <li><p>LINSERT key BEFORE|AFTER pivot value,Redis Linsert 命令用于在列表的元素前或者后插入元素。当指定元素不存在于列表中时，不执行任何操作。</p></li></ol> <h2 id="_9-hash哈希"><a href="#_9-hash哈希" class="header-anchor">#</a> 9.hash哈希</h2> <ol><li><p>常用命令 <a href="https://www.runoob.com/redis/redis-hashes.html" target="_blank" rel="noopener noreferrer">Redis 哈希(Hash) | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Redis hash 是一个 string 类型的 field（字段） 和 value（值） 的映射表，hash 特别适合用于存储对象。类似于<code>Map&lt;String,Map&lt;Object,Object&gt;&gt;</code></p></li> <li><p>hset、hget、hmset、hmget、hgetall、hdel</p></li> <li><p>hlen：获取某个key内的全部数量</p></li> <li><p>hexists key filed：查看哈希表 key 中，指定的字段是否存在</p></li> <li><p>hincrby、hincrbyfloat，增加整数、小数</p></li> <li><p>hsetnx：不存在，则添加</p></li> <li><p>案例</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hset user:001 <span class="token function">id</span> <span class="token number">11</span> name zs age <span class="token number">18</span>
<span class="token number">3</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hget user:001 <span class="token function">id</span>
<span class="token number">11</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hget user:001 name
zs
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hgetall user:001
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;11&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;zs&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;age&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;18&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hdel user:001 age
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hgetall user:001
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;11&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;zs&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hlen user:001
<span class="token number">2</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hexists user:001 name
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hexists user:001 age
<span class="token number">0</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hkesy user:001
ERR unknown <span class="token builtin class-name">command</span> <span class="token string">'hkesy'</span>, with args beginning with: <span class="token string">'user:001'</span> 
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hkeys user:001
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span>

nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hvals user:001
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;11&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;zs&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hset user:001 age <span class="token number">12</span>
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hset user:001 <span class="token builtin class-name">source</span> <span class="token number">12.1</span>
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hgetall user:001
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;11&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;zs&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;age&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;12&quot;</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;source&quot;</span>
<span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;12.1&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hincrby user:001 age <span class="token number">1</span>
<span class="token number">13</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hincrby user:001 age <span class="token number">1</span>
<span class="token number">14</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hincrby user:001 age <span class="token number">2</span>
<span class="token number">16</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hincrbyfloat user:001 <span class="token builtin class-name">source</span> <span class="token number">0.2</span>
<span class="token number">12.3</span>

nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hset user:001 email <span class="token number">11</span>@qq.com
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> hset user:001 email <span class="token number">11</span>@qq.com
<span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div></li> <li><p>应用场景：早期的jd购物车，中小型企业的购物车</p></li></ol> <h2 id="_10-set集合"><a href="#_10-set集合" class="header-anchor">#</a> 10.set集合</h2> <p>常用命令：<a href="https://www.runoob.com/redis/redis-sets.html" target="_blank" rel="noopener noreferrer">Redis 集合(Set) | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p>Redis 的 Set 是 String 类型的无序集合。集合成员是唯一的，这就意味着集合中不能出现重复的数据。集合对象的编码可以是 intset 或者 hashtable。Redis 中集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。</p></li> <li><p><code>SADD KEY_NAME VALUE1..VALUEN</code>  命令将一个或多个成员元素加入到集合中，已经存在于集合的成员元素将被忽略。</p> <p>假如集合 key 不存在，则创建一个只包含添加的元素作成员的集合。当集合 key 不是集合类型时，返回一个错误。</p></li> <li><p><code>SMEMBERS key</code> :返回集合中的所有元素</p></li> <li><p><code>SISMEMBER KEY VALUE</code>: 判断集合中的元素是否存在</p></li> <li><p><code>SREM KEY MEMBER1..MEMBERN</code> :移除集合中的元素。</p></li> <li><p><code>SCARD KEY_NAME</code> :获取元素中的个数。</p></li> <li><p><code>SRANDMEMBER KEY [count]</code> :随机展示设置数字的元素。元素不删除</p></li> <li><p><code>SPOP key [count]</code> : 随机弹出指定元素个数，元素删除。</p></li> <li><p><code>SMOVE SOURCE DESTINATION MEMBER</code> : 命令将指定成员 member 元素从 source 集合移动到 destination 集合。</p> <p>SMOVE 是原子性操作。</p></li> <li><p>集合运算</p></li> <li><p><code>SDIFF FIRST_KEY OTHER_KEY1..OTHER_KEYN</code> : Redis Sdiff 命令返回第一个集合与其他集合之间的差异，也可以认为说第一个集合中独有的元素。不存在的集合 key 将视为空集。</p> <p>差集的结果来自前面的 FIRST_KEY ,而不是后面的 OTHER_KEY1，也不是整个 FIRST_KEY OTHER_KEY1..OTHER_KEYN 的差集</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>key1 = {a,b,c,d}
key2 = {c}
key3 = {a,c,e}
SDIFF key1 key2 key3 = {b,d}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>SUNION KEY KEY1..KEYN</code> :Redis Sunion 命令返回给定集合的并集。不存在的集合 key 被视为空集。</p></li> <li><p><code>SINTER KEY KEY1..KEYN</code> :Redis Sinter 命令返回给定所有给定集合的交集。 不存在的集合 key 被视为空集。 当给定集合当中有一个空集时，结果也为空集(根据集合运算定律)。</p></li> <li><p>应用场景</p> <ul><li>小程序抽奖。从set集合中，随机取一个元素</li> <li>朋友圈点赞，查看同赞的盆友。集合的交集</li></ul></li></ol> <h2 id="_11-zset有序集合"><a href="#_11-zset有序集合" class="header-anchor">#</a> 11.zset有序集合</h2> <p>Redis 有序集合和集合一样也是 string 类型元素的集合,且不允许重复的成员。</p> <p>不同的是每个元素都会关联一个 double 类型的分数。redis 正是通过分数来为集合中的成员进行从小到大的排序。</p> <p>有序集合的成员是唯一的,但分数(score)却可以重复。</p> <p><strong>常用</strong> <a href="https://www.runoob.com/redis/redis-sorted-sets.html" target="_blank" rel="noopener noreferrer">Redis 有序集合(sorted set) | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p><code>ZADD KEY_NAME SCORE1 VALUE1.. SCOREN VALUEN</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ZADD myzset <span class="token number">1</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ZADD myzset <span class="token number">1</span> <span class="token string">&quot;uno&quot;</span>
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ZADD myzset <span class="token number">2</span> <span class="token string">&quot;two&quot;</span> <span class="token number">3</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ZRANGE myzset <span class="token number">0</span> <span class="token parameter variable">-1</span> WITHSCORES
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;uno&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p><code>ZRANGE key start stop [WITHSCORES]</code> : Redis Zrange 返回有序集中，指定区间内的成员。其中成员的位置按分数值递增(从小到大)来排序。下标参数 start 和 stop 都以 0 为底，也就是说，以 0 表示有序集第一个成员，以 1 表示有序集第二个成员，以此类推。</p> <p>你也可以使用负数下标，以 -1 表示最后一个成员， -2 表示倒数第二个成员，以此类推。</p></li> <li><p><code>ZREVRANGE key start stop [WITHSCORES]</code> :Redis Zrevrange 命令返回有序集中，指定区间内的成员。其中成员的位置按分数值递减(从大到小)来排列。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> zrevrange myzset <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;uno&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> zrevrange myzset <span class="token number">0</span> <span class="token parameter variable">-1</span> withscores
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;uno&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p><code>ZREVRANGEBYSCORE key max min [WITHSCORES] [LIMIT offset count]</code> : Redis Zrevrangebyscore 返回有序集中指定分数区间内的所有的成员。有序集成员按分数值递减(从大到小)的次序排列。</p></li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ZREVRANGEBYSCORE myzset <span class="token number">3</span> <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ZREVRANGEBYSCORE myzset <span class="token number">3</span> <span class="token number">2</span> withscores
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="5"><li><p><code>ZSCORE key member</code> ： Redis Zscore 命令返回有序集中，成员的分数值。 如果成员元素不是有序集 key 的成员，或 key 不存在，返回 nil 。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> zscore myzset uno
<span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><code>ZCARD KEY_NAME</code> : Redis Zcard 命令用于计算集合中元素的数量。</p></li> <li><p><code>ZCOUNT key min max</code> :Redis Zcount 命令用于计算有序集合中指定分数区间的成员数量。</p></li> <li><p><code>ZREM key member [member ...]</code> : Redis Zrem 命令用于移除有序集中的一个或多个成员，不存在的成员将被忽略。当 key 存在但不是有序集类型时，返回一个错误。</p></li> <li><p><code>ZINCRBY key increment member</code>: Redis Zincrby 命令对有序集合中指定成员的分数加上增量 increment,可以通过传递一个负数值 increment ，让分数减去相应的值，比如 ZINCRBY key -5 member ，就是让 member 的 score 值减去 5 。当 key 不存在，或分数不是 key 的成员时， ZINCRBY key increment member 等同于 ZADD key increment member 。</p></li></ol> <h2 id="_12-位图bitmaps"><a href="#_12-位图bitmaps" class="header-anchor">#</a> 12.位图Bitmaps</h2> <p><strong>由0和1状态表现的二进制位的bit数组</strong></p> <p><strong>能做什么</strong></p> <div class="language- extra-class"><pre><code>- 用户是否登陆过Y、N，比如京东每日签到送京豆
- 电影、广告是否被点击播放过
- 钉钉打卡上下班，签到统计
</code></pre></div><p><strong>说明</strong></p> <p>说明：用String类型作为底层数据结构实现的一种统计二值状态的数据类型。</p> <p>位图本质是数组，它是基于String数据类型的按位的操作。该数组由多个二进制位组成，每个二进制位都对应一个偏移量(我们称之为一个索引)。</p> <p><strong>基本命令</strong></p> <ul><li><p>setbit key offset value: setbit 键  偏移位 只能零或者1.Bitmap的偏移量是从零开始算的</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> setbit k1 <span class="token number">1</span> <span class="token number">1</span>
<span class="token number">0</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> setbit k1 <span class="token number">7</span> <span class="token number">1</span>
<span class="token number">0</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> get k1
A
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>gbit key offset</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>nsp2:db0&gt; getbit k1 0
0
nsp2:db0&gt; getbit k1 1
1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>strlen 不是字符串长度而是占据几个字节，超过8位后自己按照8位一组一byte再扩容</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> strlen k1
<span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>bitop： 连续2天都签到的用户</p> <p>​		加入某个网站或者系统，它的用户有1000W，做个用户id和位置的映射</p></li> <li><p>bitcount :全部键里面含有1的有多少个？</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>nsp2:db0&gt; bitcount k1
2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p><strong>引用场景</strong></p> <ul><li>一年365天，全年天天登陆占用多少字节</li> <li>按照年：按年去存储一个用户的签到情况，365 天只需要 365 / 8 ≈ 46 Byte，1000W 用户量一年也只需要 44 MB 就足够了。</li> <li>此外，在实际使用时，最好对Bitmap设置过期时间，让Redis自动删除不再需要的签到记录以节省内存开销。</li></ul> <h2 id="_13-基数统计hyperloglog"><a href="#_13-基数统计hyperloglog" class="header-anchor">#</a> 13.基数统计HyperLogLog</h2> <p><a href="https://www.runoob.com/redis/redis-hyperloglog.html" target="_blank" rel="noopener noreferrer">Redis HyperLogLog | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>用于基数估计算法的数据结构。</li> <li>常用于统计唯一值的近似值。</li></ul> <p>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定 的、并且是很小的。</p> <p>在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。</p> <p>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</p> <p><strong>需求</strong></p> <ul><li>统计某个网站的UV、统计某个文章的UV</li> <li>Unique Visitor，独立访客，一般理解为客户端IP</li> <li>需要去重考虑</li> <li>用户搜索网站关键词的数量</li> <li>统计用户每天搜索不同词条个数</li></ul> <p><strong>是什么</strong></p> <ul><li>去重复统计功能的基数估计算法-就是HyperLogLog</li> <li>基数
<ul><li>是一种数据集，去重复后的真实个数</li> <li>比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素)为5。 基数估计就是在误差可接受的范围内，快速计算基数。</li></ul></li> <li>基数统计：用于统计一个集合中不重复的元素个数，就是对集合去重复后剩余元素的计算</li> <li>去重脱水后的真实数据</li></ul> <p><strong>基本命令</strong></p> <ul><li><a href="https://www.runoob.com/redis/redis-hyperloglog.html" target="_blank" rel="noopener noreferrer">Redis HyperLogLog | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_14-redis地理空间-geo"><a href="#_14-redis地理空间-geo" class="header-anchor">#</a> 14.Redis地理空间(GEO)</h2> <p><a href="https://www.runoob.com/redis/redis-geo.html" target="_blank" rel="noopener noreferrer">Redis GEO | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>命令</strong></p> <ul><li><p>geoadd：geoadd 用于存储指定的地理空间位置，可以将一个或多个经度(longitude)、纬度(latitude)、位置名称(member)添加到指定的 key 中。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>GEOADD key longitude latitude member <span class="token punctuation">[</span>longitude latitude member <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEOADD Sicily <span class="token number">13.361389</span> <span class="token number">38.115556</span> <span class="token string">&quot;Palermo&quot;</span> <span class="token number">15.087269</span> <span class="token number">37.502669</span> <span class="token string">&quot;Catania&quot;</span>
<span class="token number">2</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEODIST Sicily Palermo Catania
<span class="token number">166274.1516</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEORADIUS Sicily <span class="token number">15</span> <span class="token number">37</span> <span class="token number">100</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;Catania&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEORADIUS Sicily <span class="token number">15</span> <span class="token number">37</span> <span class="token number">200</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;Palermo&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;Catania&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>geopos :用于从给定的 key 里返回所有指定名称(member)的位置（经度和纬度），不存在的返回 nil。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>GEOPOS key member [member ...]

nsp2:db0&gt; GEOPOS Sicily Palermo Catania NonExisting
1) 1) 13.361389338970184
2) 38.1155563954963
2) 1) 15.087267458438873
2) 37.50266842333162
3) 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>geodist 用于返回两个给定位置之间的距离。</p> <ul><li>member1 member2 为两个地理位置。</li> <li>最后一个距离单位参数说明：
<ul><li>m ：米，默认单位。</li> <li>km ：千米。</li> <li>mi ：英里。</li> <li>ft ：英尺。</li></ul></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>GEODIST key member1 member2 <span class="token punctuation">[</span>m<span class="token operator">|</span>km<span class="token operator">|</span>ft<span class="token operator">|</span>mi<span class="token punctuation">]</span>

nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEODIST Sicily Palermo Catania
<span class="token number">166274.1516</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEODIST Sicily Palermo Catania km
<span class="token number">166.2742</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>georadius、georadiusbymember</p> <ul><li><p>georadius 以给定的经纬度为中心， 返回键包含的位置元素当中， 与中心的距离不超过给定最大距离的所有位置元素。</p></li> <li><p>georadiusbymember 和 GEORADIUS 命令一样， 都可以找出位于指定范围内的元素， 但是 georadiusbymember 的中心点是由给定的位置元素决定的， 而不是使用经度和纬度来决定中心点。</p></li> <li><p>georadius 与 georadiusbymember 语法格式如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>GEORADIUS key longitude latitude radius m<span class="token operator">|</span>km<span class="token operator">|</span>ft<span class="token operator">|</span>mi <span class="token punctuation">[</span>WITHCOORD<span class="token punctuation">]</span> <span class="token punctuation">[</span>WITHDIST<span class="token punctuation">]</span> <span class="token punctuation">[</span>WITHHASH<span class="token punctuation">]</span> <span class="token punctuation">[</span>COUNT count<span class="token punctuation">]</span> <span class="token punctuation">[</span>ASC<span class="token operator">|</span>DESC<span class="token punctuation">]</span> <span class="token punctuation">[</span>STORE key<span class="token punctuation">]</span> <span class="token punctuation">[</span>STOREDIST key<span class="token punctuation">]</span>
GEORADIUSBYMEMBER key member radius m<span class="token operator">|</span>km<span class="token operator">|</span>ft<span class="token operator">|</span>mi <span class="token punctuation">[</span>WITHCOORD<span class="token punctuation">]</span> <span class="token punctuation">[</span>WITHDIST<span class="token punctuation">]</span> <span class="token punctuation">[</span>WITHHASH<span class="token punctuation">]</span> <span class="token punctuation">[</span>COUNT count<span class="token punctuation">]</span> <span class="token punctuation">[</span>ASC<span class="token operator">|</span>DESC<span class="token punctuation">]</span> <span class="token punctuation">[</span>STORE key<span class="token punctuation">]</span> <span class="token punctuation">[</span>STOREDIST key<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>参数说明：</p> <ul><li>WITHDIST: 在返回位置元素的同时， 将位置元素与中心之间的距离也一并返回。</li> <li>WITHCOORD: 将位置元素的经度和纬度也一并返回。</li> <li>WITHHASH: 以 52 位有符号整数的形式， 返回位置元素经过原始 geohash 编码的有序集合分值。 这个选项主要用于底层应用或者调试， 实际中的作用并不大。</li> <li>COUNT 限定返回的记录数。</li> <li>ASC: 查找结果根据距离从近到远排序。</li> <li>DESC: 查找结果根据从远到近排序。</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEORADIUS Sicily <span class="token number">15</span> <span class="token number">37</span> <span class="token number">200</span> km WITHDIST
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;Palermo&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;190.4424&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;Catania&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;56.4413&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEORADIUS Sicily <span class="token number">15</span> <span class="token number">37</span> <span class="token number">200</span> km WITHCOORD
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;Palermo&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">13.361389338970184</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">38.1155563954963</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;Catania&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">15.087267458438873</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">37.50266842333162</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>geohash</p> <ul><li><p>Redis GEO 使用 geohash 来保存地理位置的坐标。</p></li> <li><p>geohash 用于获取一个或多个位置元素的 geohash 值。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>GEOHASH key member <span class="token punctuation">[</span>member <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> GEOHASH Sicily Palermo Catania
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;sqc8b49rny0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;sqdtr74hyu0&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li></ul> <h2 id="_15-redis-stream"><a href="#_15-redis-stream" class="header-anchor">#</a> 15.Redis Stream</h2> <p><strong>是什么</strong></p> <ul><li>Redis Stream 是 Redis 5.0 版本新增加的数据结构。</li> <li>Redis Stream 主要用于消息队列（MQ，Message Queue），Redis 本身是有一个 Redis 发布订阅 (pub/sub) 来实现消息队列的功能，但它有个缺点就是消息无法持久化，如果出现网络断开、Redis 宕机等，消息就会被丢弃。</li> <li>简单来说发布订阅 (pub/sub) 可以分发消息，但无法记录历史消息。</li> <li>而 Redis Stream 提供了消息的持久化和主备复制功能，可以让任何客户端访问任何时刻的数据，并且能记住每一个客户端的访问位置，还能保证消息不丢失。</li> <li>Redis Stream 的结构如下所示，它有一个消息链表，将所有加入的消息都串起来，每个消息都有一个唯一的 ID 和对应的内容：</li></ul> <p><a href="https://www.runoob.com/redis/redis-stream.html" target="_blank" rel="noopener noreferrer">Redis Stream | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>能干什么</strong></p> <ul><li>实现消息队列，它支持消息的持久化、支持自动生成全局唯一 ID、支持ack确认消息的模式、支持消费组模式等，让消息队列更加的稳定和可靠</li></ul> <p><strong>基本命令</strong></p> <p><strong>消息队列相关命令：</strong></p> <ul><li><strong>XADD</strong> - 添加消息到末尾</li> <li><strong>XTRIM</strong> - 对流进行修剪，限制长度</li> <li><strong>XDEL</strong> - 删除消息</li> <li><strong>XLEN</strong> - 获取流包含的元素数量，即消息长度</li> <li><strong>XRANGE</strong> - 获取消息列表，会自动过滤已经删除的消息</li> <li><strong>XREVRANGE</strong> - 反向获取消息列表，ID 从大到小</li> <li><strong>XREAD</strong> - 以阻塞或非阻塞方式获取消息列表</li></ul> <p><strong>消费者组相关命令：</strong></p> <ul><li><strong>XGROUP CREATE</strong> - 创建消费者组</li> <li><strong>XREADGROUP GROUP</strong> - 读取消费者组中的消息</li> <li><strong>XACK</strong> - 将消息标记为&quot;已处理&quot;</li> <li><strong>XGROUP SETID</strong> - 为消费者组设置新的最后递送消息ID</li> <li><strong>XGROUP DELCONSUMER</strong> - 删除消费者</li> <li><strong>XGROUP DESTROY</strong> - 删除消费者组</li> <li><strong>XPENDING</strong> - 显示待处理消息的相关信息</li> <li><strong>XCLAIM</strong> - 转移消息的归属权</li> <li><strong>XINFO</strong> - 查看流和消费者组的相关信息；</li> <li><strong>XINFO GROUPS</strong> - 打印消费者组的信息；</li> <li><strong>XINFO STREAM</strong> - 打印流信息</li></ul></li></ul> <h2 id="_15-redis的stream流"><a href="#_15-redis的stream流" class="header-anchor">#</a> 15.Redis的Stream流</h2> <p>文档<a href="https://www.runoob.com/redis/redis-stream.html" target="_blank" rel="noopener noreferrer">Redis Stream | 菜鸟教程 (runoob.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Redis Stream 主要用于消息队列（MQ，Message Queue），Redis 本身是有一个 Redis 发布订阅 (pub/sub) 来实现消息队列的功能，但它有个缺点就是消息无法持久化，如果出现网络断开、Redis 宕机等，消息就会被丢弃。</p> <p>简单来说发布订阅 (pub/sub) 可以分发消息，但无法记录历史消息。</p> <p>而 Redis Stream 提供了消息的持久化和主备复制功能，可以让任何客户端访问任何时刻的数据，并且能记住每一个客户端的访问位置，还能保证消息不丢失。</p> <p>Redis Stream 的结构如下所示，它有一个消息链表，将所有加入的消息都串起来，每个消息都有一个唯一的 ID 和对应的内容：</p> <p><img src="/img/redis/redis-stream.png" alt=""></p> <p>操作命令</p> <ul><li>xadd</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xadd mystream * <span class="token function">id</span> <span class="token number">11</span> cname zs
<span class="token number">1722262632117</span>-0
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xadd mystream * <span class="token function">id</span> <span class="token number">12</span> cname <span class="token function">ls</span>
<span class="token number">1722262645366</span>-0
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xadd mystream * k1 v1 k2 v2 k3 v3
<span class="token number">1722262695684</span>-0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>xrange</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xrange mystream - +
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722262632117-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;11&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;cname&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;zs&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722262645366-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;12&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;cname&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;ls&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722262695684-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;k2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;k3&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
只返回两条
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xrange mystream - + count <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722262632117-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;11&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;cname&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;zs&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722262645366-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;12&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;cname&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;ls&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><ul><li>xrevrange</li></ul> <div class="language-she line-numbers-mode"><pre class="language-text"><code>nsp2:db0&gt; xrevrange mystream + -
1) 1) &quot;1722262695684-0&quot;
2) 1) &quot;k1&quot;
2) &quot;v1&quot;
3) &quot;k2&quot;
4) &quot;v2&quot;
5) &quot;k3&quot;
6) &quot;v3&quot;
2) 1) &quot;1722262645366-0&quot;
2) 1) &quot;id&quot;
2) &quot;12&quot;
3) &quot;cname&quot;
4) &quot;ls&quot;
3) 1) &quot;1722262632117-0&quot;
2) 1) &quot;id&quot;
2) &quot;11&quot;
3) &quot;cname&quot;
4) &quot;zs&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>xdel</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xdel mystream <span class="token number">1722262632117</span>-0
<span class="token number">1</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xrevrange mystream + -
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722262695684-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;k2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;k3&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722262645366-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;id&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;12&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;cname&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;ls&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>xlen</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xlen mystream
<span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>XTRIM 使用 XTRIM 对流进行修剪，限制长度， 语法格式：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>XTRIM key MAXLEN <span class="token punctuation">[</span>~<span class="token punctuation">]</span> count
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>key</strong> ：队列名称</li> <li><strong>MAXLEN</strong> ：长度</li> <li><strong>count</strong> ：数量</li></ul></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> XADD mystream * field1 A field2 B field3 C field4 D
<span class="token string">&quot;1601372434568-0&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> XTRIM mystream MAXLEN <span class="token number">2</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> XRANGE mystream - +
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1601372434568-0&quot;</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;field1&quot;</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;A&quot;</span>
      <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;field2&quot;</span>
      <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;B&quot;</span>
      <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;field3&quot;</span>
      <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;C&quot;</span>
      <span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;field4&quot;</span>
      <span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;D&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>xread</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xrange mystream - +
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263530333-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k3&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;k4&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263539031-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k5&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v5&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263606454-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k6&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v6&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263625919-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k7&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v7&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263631705-0&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k8&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v8&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xread count <span class="token number">2</span> streams mystream $
nil
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xread count <span class="token number">2</span> streams mystream <span class="token number">0</span>-0
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;mystream&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span>      <span class="token number">1</span><span class="token punctuation">)</span>      <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263530333-0&quot;</span>
        <span class="token number">2</span><span class="token punctuation">)</span>      <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k3&quot;</span>
        <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
        <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;k4&quot;</span>
        <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
        <span class="token number">2</span><span class="token punctuation">)</span>      <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263539031-0&quot;</span>
        <span class="token number">2</span><span class="token punctuation">)</span>      <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k5&quot;</span>
        <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v5&quot;</span>
        
阻塞读取
<span class="token operator">&gt;</span> xread count <span class="token number">1</span> block <span class="token number">0</span> streams mystream $
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>消费者</strong></p> <div class="language-SHEL line-numbers-mode"><pre class="language-text"><code>nsp2:db0&gt; xgroup create mystream groupX $
OK
nsp2:db0&gt; xgroup create mystream groupA 0
OK
nsp2:db0&gt; xgroup create mystream groupB 0
OK
nsp2:db0&gt; xreadgroup group groupA  consumer1 streams mystream &gt;
1) &quot;mystream&quot;
2)      1)      1) &quot;1722263530333-0&quot;
        2)      1) &quot;k3&quot;
        2) &quot;v3&quot;
        3) &quot;k4&quot;
        4) &quot;v4&quot;
        2)      1) &quot;1722263539031-0&quot;
        2)      1) &quot;k5&quot;
        2) &quot;v5&quot;
        3)      1) &quot;1722263606454-0&quot;
        2)      1) &quot;k6&quot;
        2) &quot;v6&quot;
        4)      1) &quot;1722263625919-0&quot;
        2)      1) &quot;k7&quot;
        2) &quot;v7&quot;
        5)      1) &quot;1722263631705-0&quot;
        2)      1) &quot;k8&quot;
        2) &quot;v8&quot;
# 组内已经有消费之读取消息后，第二个消费读取不到数据，默认情况下，
# 不同组的消费者可以读取到消息
nsp2:db0&gt; xreadgroup group groupA  consumer2 streams mystream &gt;

nsp2:db0&gt; 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>XREADGROUP GROUP group consumer <span class="token punctuation">[</span>COUNT count<span class="token punctuation">]</span> <span class="token punctuation">[</span>BLOCK milliseconds<span class="token punctuation">]</span> <span class="token punctuation">[</span>NOACK<span class="token punctuation">]</span> STREAMS key <span class="token punctuation">[</span>key <span class="token punctuation">..</span>.<span class="token punctuation">]</span> ID <span class="token punctuation">[</span>ID <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>group</strong> ：消费组名</li> <li><strong>consumer</strong> ：消费者名。</li> <li><strong>count</strong> ： 读取数量。</li> <li><strong>milliseconds</strong> ： 阻塞毫秒数。</li> <li><strong>key</strong> ： 队列名。</li> <li><strong>ID</strong> ： 消息 ID。</li></ul> <p><strong>xpending</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> xpending mystream groupA
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">5</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263530333-0&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;1722263631705-0&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;consumer1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;5&quot;</span>
nsp2:db<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>xack</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>nsp2:db0&gt; xpending mystream groupA - + 10 consumer1
1) 1) &quot;1722263530333-0&quot;
2) &quot;consumer1&quot;
3) 694508
4) 1
2) 1) &quot;1722263539031-0&quot;
2) &quot;consumer1&quot;
3) 694508
4) 1
3) 1) &quot;1722263606454-0&quot;
2) &quot;consumer1&quot;
3) 694508
4) 1
4) 1) &quot;1722263625919-0&quot;
2) &quot;consumer1&quot;
3) 694508
4) 1
5) 1) &quot;1722263631705-0&quot;
2) &quot;consumer1&quot;
3) 694508
4) 1
nsp2:db0&gt; xack mystream groupA 1722263530333-0 
1
nsp2:db0&gt; xpending mystream groupA - + 10 consumer1
1) 1) &quot;1722263539031-0&quot;
2) &quot;consumer1&quot;
3) 768607
4) 1
2) 1) &quot;1722263606454-0&quot;
2) &quot;consumer1&quot;
3) 768607
4) 1
3) 1) &quot;1722263625919-0&quot;
2) &quot;consumer1&quot;
3) 768607
4) 1
4) 1) &quot;1722263631705-0&quot;
2) &quot;consumer1&quot;
3) 768607
4) 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/clxmm/clxmm/edit/master/docs/01.后端学习/10.redis/01.redis开始.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=redis" title="标签">#redis</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/08/12, 22:25:20</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/2a37ab/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">02redis持久化</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/2a37ab/">02redis持久化</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/5d8882/"><div>
            vue3
            <!----></div></a> <span class="date">02-08</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/5f5ab3/"><div>
            vue3-1
            <!----></div></a> <span class="date">01-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/7908dd/"><div>
            vue3
            <!----></div></a> <span class="date">01-18</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2025
    <span>Evan Xu | <a href="https://github.com/clxmm" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5310cdc4.js" defer></script><script src="/assets/js/2.c9184447.js" defer></script><script src="/assets/js/3.b86c239d.js" defer></script><script src="/assets/js/11.f29116e0.js" defer></script>
  </body>
</html>
